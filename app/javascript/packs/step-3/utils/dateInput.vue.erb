<template src="./dateInput.html.erb"></template>

<script>
import DateUtils from './dateUtils'
import DateValidator from './dateValidator'

export default {
    name: 'date-input',
    props: [
      'value'
    ],
    data () {
        return {
            dateValue: '',
            dateValidator: {},
            showPopup: false,
            currMonthName: 'Juillet',
            currYear: '2017',
            currentMonthDays: []
        }
    },
    computed: {
        isDateValid: function() {
            return this.dateValidator.isValid || this.dateValidator.isEmpty
        }
    },
    watch: {
        value: function (value) {
            if(value != null && value.length != 0) {
                this.dateValidator = new DateValidator(value)
                this.dateValue = this.dateValidator.toInputFormatString
            }
        }
    },
    methods: {
        updateValue: function (value) {
            this.dateValue = value
            this.dateValidator = new DateValidator(this.dateValue)

            this.$emit('input', this.dateValidator.toIsoString)
        },
        clickedOnDay: function (day) {
            this.dateUtils.selectDay(day)
            this.currentMonthDays = this.dateUtils.daysOfMonth
            this.$emit('input', this.dateUtils.dateString)
        },
        setInitialValues() {
            this.dateUtils = new DateUtils(new Date())
            this.currentMonthDays = this.dateUtils.daysOfMonth
            this.dateValue = this.value
            this.dateValidator = new DateValidator(this.dateValue)
        }
    },
    mounted () {
        this.setInitialValues()
    }
}
</script>

<style lang="sass">
  input
    &::-webkit-calendar-picker-indicator
      display: none
  input[type="date"]::-webkit-input-placeholder
    visibility: hidden !important

  .ui[class*="very compact"].table th.smaller
    padding: 0.6em
    font-weight: 800
    font-size: 1.1em
    border: none
  .ui[class*="very compact"].table th.smallest
    padding: 0.3em
    font-weight: 600
    border: none

  td.selectedDay
    color: #85B7D9
    border: 1px solid #85B7D9 !important
  td.notSelectedDay
    border-top: 1px solid rgba(34, 36, 38, 0.1) !important
    border-bottom: 1px solid rgba(255,255,255,0) !important
</style>
